<!DOCTYPE html>
<!-- data-bs-theme="light" ডিফল্ট হিসেবে সেট করা হলো -->
<html lang="en" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <title>Pranto's Note</title>
    <link rel="icon" type="image/png" href="note.png"> 
    <!-- Google Font: Roboto (index.html থেকে আনা) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <style>
        /* --- index.html থেকে আনা Base & Typography --- */
        :root {
            --bs-body-font-family: 'Roboto', sans-serif;
            --bs-heading-font-family: 'Roboto', sans-serif;
            
            /* --- Light Mode (Translucent Glass) --- */
            --bs-body-bg-light: #f3e7ff; 
            --bs-body-color-light: #212529;
            --bs-tertiary-bg-light: rgba(255, 255, 255, 0.7); 
            --bs-secondary-bg-light: #f8f9fa; 
            --bs-border-color-light: rgba(0, 0, 0, 0.1); 
            
            --bs-glass-bg-light: rgba(255, 255, 255, 0.6); 
            --bs-glass-border-light: var(--bs-border-color-light);
            --bs-card-bg-light: var(--bs-tertiary-bg-light);
            --bs-card-border-light: var(--bs-border-color-light);

            /* --- Dark Mode (Translucent Glass) --- */
            --bs-body-bg-dark: #0a0c10; 
            --bs-body-color-dark: #e0e0e0;
            --bs-tertiary-bg-dark: rgba(22, 27, 34, 0.7); 
            --bs-secondary-bg-dark: #2a2a2a;
            --bs-border-color-dark: rgba(255, 255, 255, 0.1); 
            --bs-light-bg-subtle-dark: #161b22;

            --bs-glass-bg-dark: rgba(10, 12, 16, 0.6); 
            --bs-glass-border-dark: var(--bs-border-color-dark);
            --bs-card-bg-dark: var(--bs-tertiary-bg-dark); /* ডার্ক মোড কার্ডের রঙ */
            --bs-card-border-dark: var(--bs-border-color-dark);

            --bs-primary-dark: #00f0b5;
            --bs-primary-rgb-dark: 0, 240, 181;
            
            /* NEW: Sticky Header BG Colors */
            --sticky-bg-light: rgba(255, 255, 255, 0.85);
            --sticky-bg-dark: rgba(10, 12, 16, 0.85);
            --sticky-border-light: rgba(0, 0, 0, 0.1);
            --sticky-border-dark: rgba(255, 255, 255, 0.1);
            
            /* --- Attendance Status Colors --- */
            --status-present-gradient: linear-gradient(135deg, #d1e7dd, #c2e0ce);
            --status-present-text: #0f5132;
            --status-absent-gradient: linear-gradient(135deg, #f8d7da, #f1c9cd);
            --status-absent-text: #842029;
            --status-weekend-gradient: linear-gradient(135deg, #cff4fc, #bde8f8);
            --status-weekend-text: #055160;
            --status-holiday-gradient: linear-gradient(135deg, #fff3cd, #fbe9b1);
            --status-holiday-text: #664d03;
            --status-default-bg: transparent;

            --status-present-gradient-dark: linear-gradient(135deg, rgba(13, 26, 18, 0.8), rgba(12, 22, 30, 0.8));
            --status-present-text-dark: #34c356;
            --status-absent-gradient-dark: linear-gradient(135deg, rgba(43, 17, 20, 0.8), rgba(34, 17, 24, 0.8));
            --status-absent-text-dark: #ea5462;
            --status-weekend-gradient-dark: linear-gradient(135deg, rgba(3, 21, 31, 0.8), rgba(15, 19, 37, 0.8));
            --status-weekend-text-dark: #3c8aff;
            --status-holiday-gradient-dark: linear-gradient(135deg, rgba(36, 28, 10, 0.8), rgba(35, 17, 24, 0.8));
            --status-holiday-text-dark: #ffca2c;
            --status-default-bg-dark: transparent;
        }

        html {
            scroll-behavior: smooth;
        }

        [data-bs-theme="light"] {
            --bs-body-bg: var(--bs-body-bg-light);
            --bs-body-color: var(--bs-body-color-light);
            --bs-tertiary-bg: var(--bs-tertiary-bg-light);
            --bs-secondary-bg: var(--bs-secondary-bg-light);
            --bs-border-color: var(--bs-border-color-light);
            --bs-light-bg-subtle: var(--bs-light-bg-subtle-light);

            --bs-glass-bg: var(--bs-glass-bg-light);
            --bs-glass-border: var(--bs-glass-border-light);
            --bs-card-bg: var(--bs-card-bg-light);
            --bs-card-border: var(--bs-card-border-light);
            
            --sticky-bg: var(--sticky-bg-light);
            --sticky-border: var(--sticky-border-light);
            
            /* Attendance Status */
            --status-present-gradient: var(--status-present-gradient);
            --status-present-text: var(--status-present-text);
            --status-absent-gradient: var(--status-absent-gradient);
            --status-absent-text: var(--status-absent-text);
            --status-weekend-gradient: var(--status-weekend-gradient);
            --status-weekend-text: var(--status-weekend-text);
            --status-holiday-gradient: var(--status-holiday-gradient);
            --status-holiday-text: var(--status-holiday-text);
            --status-default-bg: var(--status-default-bg);
        }

        [data-bs-theme="dark"] {
            --bs-body-bg: var(--bs-body-bg-dark);
            --bs-body-color: var(--bs-body-color-dark);
            --bs-tertiary-bg: var(--bs-tertiary-bg-dark);
            --bs-secondary-bg: var(--bs-secondary-bg-dark);
            --bs-border-color: var(--bs-border-color-dark);
            --bs-light-bg-subtle: var(--bs-light-bg-subtle-dark);

            --bs-glass-bg: var(--bs-glass-bg-dark);
            --bs-glass-border: var(--bs-glass-border-dark);
            --bs-card-bg: var(--bs-card-bg-dark);
            --bs-card-border: var(--bs-border-color-dark);

            --bs-primary: var(--bs-primary-dark);
            --bs-primary-rgb: var(--bs-primary-rgb-dark);
            --bs-link-color: var(--bs-primary-dark);
            --bs-link-color-rgb: var(--bs-primary-rgb-dark);
            --bs-link-hover-color: #33ffc7;
            
            --sticky-bg: var(--sticky-bg-dark);
            --sticky-border: var(--sticky-border-dark);
            
            /* Attendance Status */
            --status-present-gradient: var(--status-present-gradient-dark);
            --status-present-text: var(--status-present-text-dark);
            --status-absent-gradient: var(--status-absent-gradient-dark);
            --status-absent-text: var(--status-absent-text-dark);
            --status-weekend-gradient: var(--status-weekend-gradient-dark);
            --status-weekend-text: var(--status-weekend-text-dark);
            --status-holiday-gradient: var(--status-holiday-gradient-dark);
            --status-holiday-text: var(--status-holiday-text-dark);
            --status-default-bg: var(--status-default-bg-dark);
        }

        body {
            font-family: var(--bs-body-font-family); 
            background-color: transparent; 
            transition: background-color 0.3s ease;
            overflow: hidden; /* Hide main scrollbar */
        }
        
        /* --- Animated Background --- */
        #animated-bg-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: -10; 
            overflow: hidden;
        }
        .bg-image {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            filter: blur(20px); 
            -webkit-filter: blur(20px);
            opacity: 0;
            transition: opacity 1.5s ease-in-out; 
            transform: scale(1.1); 
        }
        .bg-image.active {
            opacity: 1;
        }
        /* Light Theme Images */
        [data-bs-theme="light"] .bg-image-light.bg-1 { background-image: url('https://cdn.pixabay.com/photo/2014/09/21/14/39/surface-455124_1280.jpg'); }
        [data-bs-theme="light"] .bg-image-light.bg-2 { background-image: url('https://cdn.pixabay.com/photo/2015/10/24/11/09/drop-1004250_1280.jpg'); }
        [data-bs-theme="light"] .bg-image-light.bg-3 { background-image: url('https://cdn.pixabay.com/photo/2024/12/04/15/37/leaves-9244714_1280.jpg'); }
        
        /* Dark Theme Images */
        [data-bs-theme="dark"] .bg-image-dark.bg-1 { background-image: url('https://cdn.pixabay.com/photo/2022/08/02/02/28/cherry-7359319_1280.jpg'); }
        [data-bs-theme="dark"] .bg-image-dark.bg-2 { background-image: url('https://cdn.pixabay.com/photo/2020/04/20/20/47/red-5069808_1280.jpg'); }
        [data-bs-theme="dark"] .bg-image-dark.bg-3 { background-image: url('https://cdn.pixabay.com/photo/2015/07/10/14/56/moon-839306_1280.jpg'); }

        [data-bs-theme="light"] .bg-image-dark { display: none; }
        [data-bs-theme="dark"] .bg-image-light { display: none; }
        
        h1, h2, h3, h4, h5, h6, .display-4, .sidebar-title, .fw-bold {
            font-family: var(--bs-heading-font-family);
            font-weight: 700;
        }

        /* --- Scroll Reveal Animation --- */
        .fade-in-section {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .fade-in-section.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* --- General Animations & Buttons --- */
        .btn {
            transition: all 0.2s ease-in-out;
        }
        .btn-primary:hover {
            transform: scale(1.03);
            box-shadow: 0 4px 15px rgba(var(--bs-primary-rgb), 0.3);
        }
        [data-bs-theme="dark"] .btn-primary {
            background-color: var(--bs-primary-dark);
            border-color: var(--bs-primary-dark);
            color: #000;
        }
        [data-bs-theme="dark"] .btn-primary:hover {
             background-color: #33ffc7;
             border-color: #33ffc7;
             color: #000;
             box-shadow: 0 4px 15px rgba(0, 240, 181, 0.3);
        }

        /* --- Page Sections --- */
        .page-section {
            padding-top: 2.5rem;
        }
        #profile-section {
            padding-top: 0;
        }
        
        /* --- Login Page --- */
        #login-page {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background-image: url('https://images.unsplash.com/photo-1594122230689-45899d9e7f69?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
        }
        .login-card {
            display: flex;
            width: 100%;
            max-width: 900px;
            min-height: 550px;
            background-color: rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            overflow: hidden;
        }
        [data-bs-theme="dark"] #login-page {
             background-image: none;
             background-color: var(--bs-body-bg-dark); 
             background-image: radial-gradient(circle at top center, rgba(0, 240, 181, 0.1), transparent 30%);
             background-repeat: no-repeat;
             background-size: 100% 1000px;
        }
        [data-bs-theme="dark"] .login-card {
            background-color: var(--bs-tertiary-bg-dark);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: 1px solid var(--bs-border-color-dark);
        }
        .login-form-side {
            flex: 0 0 55%;
            padding: 4rem;
        }
        .login-input-group .form-control {
            border-radius: 0.75rem;
            padding: 0.75rem 1rem 0.75rem 3rem;
            background-color: rgba(255, 255, 255, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        [data-bs-theme="dark"] .login-input-group .form-control {
             background-color: rgba(0, 0, 0, 0.2);
            border: 1px solid var(--bs-border-color-dark);
            color: var(--bs-body-color-dark);
        }
        .login-input-group i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--bs-secondary-color);
            z-index: 5;
        }
        .login-welcome-side {
            flex: 0 0 45%;
            padding: 4rem;
            color: #000;
        }
        [data-bs-theme="dark"] .login-welcome-side {
            color: #fff; 
            background-color: rgba(0,0,0,0.2); 
        }

        /* --- Dashboard Layout --- */
        #dashboard-page {
            min-height: 100vh;
            display: none;
        }

        /* --- Sidebar --- */
        #sidebar {
            width: 280px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            background-color: var(--bs-glass-bg);
            border-right: 1px solid var(--bs-glass-border);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            z-index: 1020;
        }
        [data-bs-theme="light"] #sidebar {
            border-radius: 0 1.5rem 1.5rem 0; 
            border-right: none;
        }
        [data-bs-theme="dark"] #sidebar {
            box-shadow: none;
            border-right-color: var(--bs-border-color-dark);
        }
        /* Sidebar minimize */
        #sidebar.minimized { width: 90px; }
        #sidebar.minimized .sidebar-title,
        #sidebar.minimized .nav-link-text { display: none; }
        #sidebar.minimized .nav-link { justify-content: center; }
        #sidebar.minimized .nav-link i { margin-right: 0; }
        #sidebar.minimized #sidebar-toggle-button { transform: rotate(180deg); }
        
        .sidebar-logo-icon {
            background: linear-gradient(to right, #6a11cb 0%, #2575fc 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        [data-bs-theme="dark"] .sidebar-logo-icon {
            background: linear-gradient(to right, #00f0b5 0%, #00c9ff 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        #sidebar .nav-link {
            color: var(--bs-secondary-color);
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }
        [data-bs-theme="light"] #sidebar .nav-link { color: #495057; }
        [data-bs-theme="light"] #sidebar .nav-link:hover { background-color: #f1f3f5; color: var(--bs-primary); }
        [data-bs-theme="light"] #sidebar .nav-link.active {
            background-image: linear-gradient(to right, #6a11cb 0%, #2575fc 100%);
            color: #fff;
            box-shadow: 0 4px 12px rgba(var(--bs-primary-rgb), 0.3);
        }
        [data-bs-theme="dark"] #sidebar .nav-link:hover {
            background-color: var(--bs-secondary-bg-dark);
            color: var(--bs-primary-dark);
        }
        [data-bs-theme="dark"] #sidebar .nav-link.active {
            background-image: linear-gradient(to right, #00f0b5 0%, #00c9ff 100%);
            color: #000;
            box-shadow: 0 4px 12px rgba(var(--bs-primary-rgb-dark), 0.3);
        }
        .nav-link-text { white-space: nowrap; }

        /* --- Main Content --- */
        #main-content {
            margin-left: 280px;
            width: calc(100% - 280px);
            transition: margin-left 0.3s ease, width 0.3s ease;
            padding: 2.5rem;
            height: 100vh;
            overflow-y: auto;
        }
        #main-content.sidebar-minimized {
            margin-left: 90px;
            width: calc(100% - 90px);
        }
        [data-bs-theme="light"] #main-content h2 { color: #432263; }
        
        /* Glass Card */
        .card {
            background-color: var(--bs-card-bg);
            border: 1px solid var(--bs-card-border);
            border-radius: 1.5rem;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.07);
        }
        [data-bs-theme="dark"] .card {
             box-shadow: none;
             border-radius: 0.75rem; 
        }

        /* Profile Section */
        #profile-section .card { padding: 0; overflow: hidden; }
        .profile-card-banner-img { height: 400px; width: 100%; object-fit: cover; }
        .profile-card-avatar {
            width: 230px;
            height: 230px;
            object-fit: cover;
            border-radius: 50%;
            border: 5px solid;
            border-color: var(--bs-card-bg);
            margin-top: -250px; 
            position: relative;
            z-index: 2;
            margin-left: -31px;
        }
        .profile-stats {
            padding: 1.5rem 0;
            border-top: 1px solid var(--bs-border-color);
            border-bottom: 1px solid var(--bs-border-color);
        }
        
        /* Gradient Cards */
        .gradient-card { border: none; }
        .grad-1 { background-image: linear-gradient(to right, #d1e7dd, #cce3de, var(--bs-card-bg)); }
        .grad-2 { background-image: linear-gradient(to right, #cff4fc, #d6dffc, var(--bs-card-bg)); }
        .grad-3 { background-image: linear-gradient(to right, #fff3cd, #fde4e4, var(--bs-card-bg)); }
        [data-bs-theme="dark"] .grad-1 { background-image: linear-gradient(to right, #0d1a13, #0c151e, var(--bs-card-bg)); }
        [data-bs-theme="dark"] .grad-2 { background-image: linear-gradient(to right, #03151f, #0f1325, var(--bs-card-bg)); }
        [data-bs-theme="dark"] .grad-3 { background-image: linear-gradient(to right, #241c0a, #231118, var(--bs-card-bg)); }

        /* Slideshow */
        .slide-1-bg { background-image: linear-gradient(to right, #a1c4fd, #c2e9fb); }
        .slide-2-bg { background-image: linear-gradient(to right, #b2f0c7, #b4f7e8); }
        .slide-3-bg { background-image: linear-gradient(to right, #fecfdf, #fef4b0); }
        .carousel-item { height: 400px; }
        .carousel-item::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.2); z-index: 1;
        }
        [data-bs-theme="dark"] .carousel-item::before { background: rgba(0,0,0,0.5); }
        .slide-content { position: relative; z-index: 2; }
        .slide-content-light-text .slide-content,
        .slide-content-light-text .slide-content h3 { color: #000; }
        .slide-content-light-text .slide-content h3 { border-bottom-color: rgba(0,0,0,0.3) !important; }
        .slide-content-light-text .slide-table { background: rgba(255, 255, 255, 0.3); color: #000; border-color: rgba(0,0,0,0.2); }
        [data-bs-theme="dark"] .slide-content-light-text .slide-content,
        [data-bs-theme="dark"] .slide-content-light-text .slide-content h3 { color: #fff; }
        [data-bs-theme="dark"] .slide-content-light-text .slide-content h3 { border-bottom-color: rgba(255,255,255,0.3) !important; }
        [data-bs-theme="dark"] .slide-content-light-text .slide-table { background: rgba(0, 0, 0, 0.2); color: #fff; border-color: var(--bs-border-color-dark); }
        
        /* Calendar */
        .calendar-wrapper { position: relative; }
        .calendar-wrapper::before {
            content: '\F28B'; font-family: "bootstrap-icons" !important;
            font-size: 10rem; color: var(--bs-secondary-bg);
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); opacity: 0.5; z-index: 0;
        }
        [data-bs-theme="light"] .calendar-wrapper::before { color: #f1f3f5; }
        #calendar-grid { z-index: 1; position: relative; }
        .calendar-day-item { height: 35px; font-size: 0.8rem; font-weight: 500; }
        .calendar-day-item.today { border: 2px solid var(--bs-primary); }
        #calendar-grid-header, #calendar-grid {
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 2px;
        }

        /* Summary Boxes */
        .summary-card:hover { transform: translateY(-4px); }
        .summary-card .icon { font-size: 1.5rem; }
        .summary-card .value { font-size: 1.75rem; font-weight: 700; }

        /* Attendance Table */
        .table-responsive-wrapper {
            max-height: 70vh;
            overflow-y: auto;
            border: 1px solid var(--bs-card-border);
            background-color: var(--bs-card-bg);
        }
        .attendance-table thead th {
            background-color: var(--bs-secondary-bg);
            position: sticky; top: 0; z-index: 1;
        }
        .attendance-table tbody tr:hover {
            transform: translateY(-3px); 
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            z-index: 2; position: relative;
        }
        [data-bs-theme="dark"] .attendance-table tbody tr:hover { box-shadow: 0 8px 20px rgba(0,0,0,0.3); }
        
        /* Attendance Status Colors */
        .status-btn { border: none; font-weight: 600; }
        .status-present { background-color: #50cf6b; color: white; }
        .status-absent { background-color: #dc3545; color: white; }
        .status-weekend { background-color: #0d6efd; color: white; }
        .status-holiday { background-color: #ffc107; color: #000; }
        .status-default { background-color: #6c757d; color: white; }
        
        /* Text-like button for table */
        .btn-text-like {
            background: none; border: none; padding: 0; margin: 0;
            color: inherit; text-align: center; width: 100%; cursor: pointer;
        }
        .btn-text-like:hover { background-color: rgba(0,0,0,0.05); }
        [data-bs-theme="dark"] .btn-text-like:hover { background-color: rgba(255,255,255,0.05); }

        /* --- Footer --- */
        #main-footer {
            background-color: var(--bs-card-bg);
            border-top: 1px solid var(--bs-card-border);
            padding: 3rem 1rem; margin-top: 3rem;
            color: var(--bs-secondary-color); border-radius: 10px;
        }
        #main-footer h5 { color: var(--bs-body-color); }
        #main-footer .footer-links { list-style: none; padding-left: 0; }
        #main-footer .footer-links a { text-decoration: none; color: var(--bs-secondary-color); }
        #main-footer .footer-links a:hover { color: var(--bs-primary); }
        #main-footer .social-links a { font-size: 1.5rem; color: var(--bs-secondary-color); margin-right: 1rem; }
        #main-footer .social-links a:hover { color: var(--bs-primary); }

        /* Modal */
        .modal.zoom .modal-dialog {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            transform: scale(0.5); opacity: 0;
        }
        .modal.zoom.show .modal-dialog { transform: scale(1); opacity: 1; }
        .modal-content {
             background-color: var(--bs-glass-bg-light); 
             backdrop-filter: blur(20px);
             -webkit-backdrop-filter: blur(20px);
             border: 1px solid var(--bs-card-border-light);
             border-radius: 1rem;
        }
        [data-bs-theme="dark"] .modal-content {
             background-color: var(--bs-glass-bg-dark); 
             border: 1px solid var(--bs-card-border-dark);
        }
        
        /* Theme/Logout Button */
        .btn-theme-toggle, .btn-logout {
            background-color: var(--bs-secondary-bg);
            border: 1px solid var(--bs-border-color);
            color: var(--bs-secondary-color);
            font-weight: 600;
            border-radius: 13px;
        }
        .btn-theme-toggle:hover {
            background-color: var(--bs-primary); border-color: var(--bs-primary);
            color: #fff; box-shadow: 0 4px 12px rgba(var(--bs-primary-rgb), 0.3);
        }
        .btn-logout:hover {
            background-color: var(--bs-danger); border-color: var(--bs-danger);
            color: #fff; box-shadow: 0 4px 12px rgba(var(--bs-danger-rgb), 0.3);
        }
        [data-bs-theme="dark"] .btn-theme-toggle,
        [data-bs-theme="dark"] .btn-logout {
            background-color: var(--bs-tertiary-bg-dark);
            border-color: var(--bs-border-color-dark);
            color: var(--bs-body-color-dark);
        }
        [data-bs-theme="dark"] .btn-theme-toggle:hover {
            background-color: var(--bs-primary-dark); border-color: var(--bs-primary-dark);
            color: #000; box-shadow: 0 4px 12px rgba(var(--bs-primary-rgb-dark), 0.3);
        }
        [data-bs-theme="dark"] .btn-logout:hover {
            background-color: var(--bs-danger); border-color: var(--bs-danger); color: #fff;
        }

        /* Inline Fixes */
        #login-page { display: flex; }
        #dashboard-page { display: none; }
        #calendar-grid-header { gap: 2px; }
        #calendar-grid { gap: 2px; }
        #comments-summary-list { max-height: 250px; overflow-y: auto; }
        .attendance-table th:nth-child(1) { width: 10%; }
        .attendance-table th:nth-child(2) { width: 8%; }
        .attendance-table th:nth-child(3) { width: 14%; }
        .attendance-table th:nth-child(4) { width: 8%; }
        .attendance-table th:nth-child(5) { width: 8%; }
        .attendance-table th:nth-child(6) { width: 12%; }
        .attendance-table th:nth-child(7) { width: 10%; }
        .attendance-table th:nth-child(8) { width: 30%; }
        .progress { height: 10px; }

    </style>
</head>

<body>
    <!-- ======== NEW: Animated BG Container ======== -->
    <div id="animated-bg-container">
        <!-- Light Theme Images -->
        <div class="bg-image bg-image-light bg-1 active"></div>
        <div class="bg-image bg-image-light bg-2"></div>
        <div class="bg-image bg-image-light bg-3"></div>
        <div class="bg-image bg-image-light bg-4"></div>
        <div class="bg-image bg-image-light bg-5"></div>
        <!-- Dark Theme Images -->
        <div class="bg-image bg-image-dark bg-1"></div>
        <div class="bg-image bg-image-dark bg-2"></div>
        <div class="bg-image bg-image-dark bg-3"></div>
        <div class="bg-image bg-image-dark bg-4"></div>
        <div class="bg-image bg-image-dark bg-5"></div>
    </div>


    <!-- ======== NEW LOGIN PAGE ======== -->
    <div id="login-page" class="container-fluid p-0">
        <div class="login-card shadow">
            <!-- Form Side (Left) -->
            <div class="login-form-side">
                <h1 class="h3 mb-2 fw-bold">Hello!</h1>
                <p class="text-muted mb-4">Sign in to your account</p>
                <form id="login-form">
                    <div id="login-alert" class="alert alert-danger d-none" role="alert">
                        Invalid credentials. Please try again.
                    </div>
                    <div class="mb-3">
                        <label for="email-input" class="form-label">E-mail</label>
                        <div class="login-input-group">
                            <i class="bi bi-envelope-fill"></i>
                            <input type="email" class="form-control form-control-lg" id="email-input" placeholder="user@leverngear.com" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="password-input" class="form-label">Password: <b>pranto</b></label>
                        <div class="login-input-group">
                            <i class="bi bi-lock-fill"></i>
                            <input type="password" class="form-control form-control-lg" id="password-input" placeholder="Password" required>
                        </div>
                    </div>
                    <div class="d-grid mt-4">
                        <button type="submit" class="btn btn-primary btn-lg fw-semibold">Sign In</button>
                    </div>
                </form>
            </div>
            <!-- Welcome Side (Right) -->
            <div class="login-welcome-side">
                <h2>Welcome Back!</h2>
                <p>Enter your personal details and start your journey with us. This dashboard is your new home for tracking performance and managing attendance.</p>
            </div>
        </div>
    </div>
    
    <!-- ======== DASHBOARD PAGE ======== -->
    <div id="dashboard-page">
        
        <!-- ======== SIDEBAR ======== -->
        <div id="sidebar" class="d-flex flex-column p-3">
            <!-- Header -->
            <div class="d-flex align-items-center justify-content-between mb-4">
                <a href="#" class="d-flex align-items-center text-decoration-none text-body">
                    <i class="bi bi-p-circle fs-2 sidebar-logo-icon"></i>
                    <span class="fs-4 ms-2 sidebar-title">Pranto's Workspace</span>
                </a>
                <!-- NEW: Minimize Button -->
                <button id="sidebar-toggle-button" class="btn btn-light d-none d-md-block">
                    <i class="bi bi-chevron-left"></i>
                </button>
            </div>
            
            <!-- Navigation -->
            <ul class="nav nav-pills flex-column flex-grow-1">
                <li class="nav-item mb-1">
                    <a href="#profile-section" class="nav-link active">
                        <i class="bi bi-person-circle"></i>
                        <span class="nav-link-text">&nbsp;Profile</span>
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="#performance-section" class="nav-link">
                        <i class="bi bi-activity"></i>
                        <span class="nav-link-text">&nbsp;Performance</span>
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="#details-section" class="nav-link">
                        <i class="bi bi-clipboard2-data"></i>
                        <span class="nav-link-text">&nbsp;Detailed Data</span>
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="#dashboard-section" class="nav-link">
                        <i class="bi bi-grid-1x2"></i>
                        <span class="nav-link-text">&nbsp;Dashboard</span>
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="#summary-section" class="nav-link">
                        <i class="bi bi-bar-chart"></i>
                        <span class="nav-link-text">&nbsp;Monthly Summary</span>
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="#attendance-section" class="nav-link">
                        <i class="bi bi-calendar-check"></i>
                        <span class="nav-link-text">&nbsp;Attendance Input</span>
                    </a>
                </li>
                
                <!-- ======== "Corr. Note" DROPDOWN (KEPT) ======== -->
                <li class="nav-item mb-1">
                    <a href="#corr-note-submenu" data-bs-toggle="collapse" class="nav-link" aria-expanded="false">
                        <i class="bi bi-file-earmark-text"></i>
                        <span class="nav-link-text">&nbsp;Correspondence Note</span>
                        <i class="bi bi-chevron-down ms-auto nav-link-text"></i> <!-- Dropdown arrow -->
                    </a>
                    <!-- Submenu -->
                    <div class="collapse" id="corr-note-submenu">
                        <ul class="nav flex-column ms-4 mt-1"> 
                            <li class="nav-item">
                                <!-- Use target="_blank" so it opens in a new tab -->
                                <a href="notes-content.html" class="nav-link py-1 nav-link-text force-self-load" style="font-size: 0.9rem;">
                                    IDR Notes
                                </a>
                            </li>
                          </ul>
                    </div>
                </li>
                <!-- ======== END NEW DROPDOWN ======== -->
                
            </ul>
            
            <!-- Footer -->
            <div class="mt-auto pt-3 border-top border-2">
                <!-- NEW: Redesigned Buttons -->
                <button id="theme-toggle" class="btn btn-theme-toggle w-100 mb-2 d-flex align-items-center justify-content-center">
                    <i id="theme-icon" class="bi bi-sun-fill me-2"></i>
                    <span id="theme-text" class="nav-link-text fw-medium">Light Mode</span>
                </button>
                <button id="logout-button" class="btn btn-logout w-100 d-flex align-items-center justify-content-center">
                    <i class="bi bi-box-arrow-left me-2"></i>
                    <span class="nav-link-text fw-medium">Logout</span>
                </button>
                </br>

                <p>Made by <span class="text-primary">@PrantoRodrix</span></p>
            </div>
        </div>

        <!-- ======== MAIN CONTENT ======== -->
        <div id="main-content">
            
            <!-- ======== 1. PROFILE SECTION (NEW DESIGN) ======== -->
            <section id="profile-section" class="page-section">
                <!-- NEW: Added .fade-in-section -->
                <div class="card shadow-sm border-0 rounded-3 overflow-hidden fade-in-section">
                    <!-- Profile Banner -->
                    <img id="profile-cover-photo" src="https://placehold.co/1000x250/6a11cb/ffffff?text=Cover+Photo" class="profile-card-banner-img" alt="Profile Cover Photo">
                    
                    <!-- Profile Body -->
                    <div class="profile-card-body text-center">
                        <!-- Avatar -->
                        <img id="profile-pic" src="https://placehold.co/150x150/0d6efd/ffffff?text=PA" alt="Profile Picture" class="profile-card-avatar">
                        
                        <!-- Info -->
                        <div class="d-flex justify-content-between align-items-center mt-3">
                            <span class="invisible"></span> <!-- Spacer -->
                            <div class="text-center">
                                <h2 id="name-display" class="card-title mb-0">PrantoAnthony</h2>
                                <p id="designation-short-display" class="text-primary fs-5 fw-medium mb-0">Junior Associate</p>
                            </div>
                            <button id="edit-button" class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#edit-modal">
                                Edit
                            </button>
                        </div>
                        
                        <!-- Stats -->
                        <div class="profile-stats row g-0 my-4">
                            <div class="col-4 profile-stats-item">
                                <h6>Joining Duration</h6>
                                <p id="joining-duration-display">4 Years, 0 Months, 28 Days</p>
                                </br><h6 class="text-muted small text-uppercase mb-">Full Designation</h6>
                            <p id="designation-full-display" class="fw-semibold mb-0">Junior Associate</p>
                            
                            </div>
                            <div class="col-4 profile-stats-item">
                                <h6>Team</h6>
                                <p id="team-display">BCBS</p>
                                <h6 class="text-muted small text-uppercase mb-1 mt-3">Employment Type</h6>
                            <p id="emp-type-display" class="fw-semibold mb-0">Resource pool</p>
                       
                            </div>
                            <div class="col-4 profile-stats-item">
                                <h6>LnG ID</h6>
                                <p id="lng-id-display">LnG2110R0218</p>
                            </div>
                            
                        </div>
                        
                    </div>
                </div>
            </section>

            <!-- ======== 2. PERFORMANCE SECTION ======== -->
            <section id="performance-section" class="page-section">
                <h2 class="mb-4 fade-in-section">Performance (Monthly Data)</h2>
                <!-- NEW: Added .fade-in-section -->
                <div class="row g-4 fade-in-section">
                    <!-- Box 1: Total Working Days -->
                    <div class="col-4">
                        <div class="card h-100 gradient-card grad-1 rounded-3">
                            <div class="card-body p-4">
                                <h5 class="card-title fw-semibold text-success-emphasis">Total Working Days</h5>
                                <div id="data-box-working-days" class="fs-1 fw-bold text-success-emphasis my-2">26</div>
                                <p class="card-text text-muted mb-0">* For the selected month (Excl. Sundays)</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Box 2: COLA Eligibility -->
                    <div class="col-4">
                        <div class="card h-100 gradient-card grad-2 rounded-3">
                            <div class="card-body p-4">
                                <h5 class="card-title fw-semibold text-primary-emphasis">COLA Eligibility</h5>
                                <div id="data-box-cola" class="fs-1 fw-bold text-primary-emphasis my-2">0 / 22</div>
                                <!-- Progress Bar -->
                                <div class="progress" role="progressbar" aria-label="COLA progress" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                    <div id="cola-progress-bar" class="progress-bar bg-primary"></div>
                                </div>
                                <p id="data-box-cola-needed" class="card-text text-muted mb-0 mt-2 small">Need present: 22 days</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Box 3: Category -->
                    <div class="col-4">
                        <div class="card h-100 gradient-card grad-3 rounded-3">
                            <div class="card-body p-4">
                                <h5 class="card-title fw-semibold text-warning-emphasis">Category</h5>
                                <div id="data-box-category" class="fs-1 fw-bold text-warning-emphasis my-2">N/A</div>
                                <p id="data-box-category-desc" class="card-text text-muted mb-0 small">* Based on Total Present %</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ======== 3. DETAILED DATA (SLIDESHOW) ======== -->
            <section id="details-section" class="page-section">
                <h2 class="mb-4 fade-in-section">Detailed Data & Rules</h2>
                <!-- NEW: Added .fade-in-section -->
                <div id="slideshow" class="carousel slide carousel-fade rounded-3 overflow-hidden shadow-lg fade-in-section" data-bs-ride="carousel" data-bs-interval="5000">
                    <div class="carousel-indicators">
                        <button type="button" data-bs-target="#slideshow" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                        <button type="button" data-bs-target="#slideshow" data-bs-slide-to="1" aria-label="Slide 2"></button>
                        <button type="button" data-bs-target="#slideshow" data-bs-slide-to="2" aria-label="Slide 3"></button>
                    </div>
                    <div class="carousel-inner">
                        <!-- Slide 1: Total Working Days Details (NEW: Added .slide-content-light-text) -->
                        <div class="carousel-item active slide-1-bg slide-content-light-text">
                            <div class="d-flex align-items-center justify-content-center h-100">
                                <div class="slide-content text-center p-4">
                                    <h3 class="mb-3 border-bottom pb-2">Total Working Days Details</h3>
                                    <div class="fs-5">
                                        <p>Selected Month: <span id="slide-selected-month" class="fw-bolder">November 2025</span></p>
                                        <p>Total Days in Period: <span id="slide-total-days" class="fw-bolder">31</span></p>
                                        <p>Total Sundays: <span id="slide-total-sundays" class="fw-bolder">5</span></p>
                                        <p>Total Holidays: <span id="slide-total-holidays" class="fw-bolder">0</span></p>
                                        <p class="text-warning fw-bolder fs-4">Calculated Working Days: <span id="slide-working-days">26</span></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Slide 2: COLA Eligibility Details (NEW: Added .slide-content-light-text) -->
                        <div class="carousel-item slide-2-bg slide-content-light-text">
                             <div class="d-flex align-items-center justify-content-center h-100">
                                <div class="slide-content text-center p-4">
                                    <h3 class="mb-3 border-bottom pb-2">COLA Eligibility Details (Rules)</h3>
                                    <div class="fs-5 text-start mx-auto">
                                        <p class="fw-bolder text-warning">COLA Rules:</p>
                                        <ul class="list-unstyled">
                                            <li class="mb-2"><i class="bi bi-check-circle-fill me-2"></i>If Working days <strong>26-27</strong>, Need present <strong>22 days</strong>.</li>
                                            <li class="mb-2"><i class="bi bi-check-circle-fill me-2"></i>If working days <strong>24-25</strong>, Need present <strong>21 days</strong>.</li>
                                            <li class="mb-2"><i class="bi bi-check-circle-fill me-2"></i>If working days <strong>&lt; 24</strong>, Need Present <strong>20 days</strong>.</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Slide 3: Employee Category Details (NEW: Added .slide-content-light-text, removed .table-dark) -->
                        <div class="carousel-item slide-3-bg slide-content-light-text">
                            <div class="d-flex align-items-center justify-content-center h-100">
                                <div class="slide-content text-center p-4 w-100">
                                    <h3 class="mb-3 border-bottom pb-2">Employee Category Details</h3>
                                    <div class="overflow-x-auto">
                                        <table class="table table-striped table-bordered slide-table m-0">
                                            <thead>
                                                <tr>
                                                    <th>Category</th>
                                                    <th>Treated As</th>
                                                    <th>Eligibility (Present %)</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr><td>A</td><td>Excellent</td><td>90% - 100%</td></tr>
                                                <tr><td>B</td><td>Very Good</td><td>85% - 89%</td></tr>
                                                <tr><td>C</td><td>Good</td><td>80% - 84%</td></tr>
                                                <tr><td>D</td><td>Need Improvement</td><td>75% - 79%</td></tr>
                                                <tr class="table-danger fw-bold"><td>E</td><td>Failure</td><td>Below 74%</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <button class="carousel-control-prev" type="button" data-bs-target="#slideshow" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next" type="button" data-bs-target="#slideshow" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </section>
            
            <!-- ======== 4. MONTHLY DASHBOARD ======== -->
            <section id="dashboard-section" class="page-section">
                <h2 class="mb-4 fade-in-section">Monthly Dashboard</h2>
                <!-- NEW: Added .fade-in-section -->
                <div class="row g-4 fade-in-section">
                    <!-- Box 1: Month Selector -->
                    <div class="col-3">
                        <div class="card h-100 shadow-sm gradient-card grad-1 rounded-3">
                            <div class="card-body p-4 text-center d-flex flex-column justify-content-center">
                                <label for="month-selector" class="form-label fw-semibold text-success-emphasis">Select Month:</label>
                                <select id="month-selector" class="form-select form-select-lg mb-2">
                                    <!-- Options added by JS -->
                                </select>
                                <div class="text-muted small">
                                    <p class="mb-0">From: <span id="date-from" class="fw-bold text-success-emphasis">Oct 26, 2025</span></p>
                                    <p class="mb-0">To: <span id="date-to" class="fw-bold text-success-emphasis">Nov 25, 2025</span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Box 2: Total Present % -->
                    <div class="col-3">
                        <div class="card h-100 shadow-sm gradient-card grad-2 rounded-3">
                            <div class="card-body p-4 text-center d-flex flex-column justify-content-center">
                                <h6 class="card-title fw-semibold text-primary-emphasis">Total Present (vs Duty)</h6>
                                <div id="dashboard-present-percentage" class="display-4 fw-bolder text-primary-emphasis my-2">0%</div>
                                <p class="text-muted small mb-0">Present / (Present + Absent)</p>
                            </div>
                        </div>
                    </div>
                    <!-- Box 3: Total Present Days -->
                    <div class="col-3">
                        <div class="card h-100 shadow-sm gradient-card grad-3 rounded-3">
                            <div class="card-body p-4 text-center d-flex flex-column justify-content-center">
                                <h6 class="card-title fw-semibold text-warning-emphasis">Total Present Days</h6>
                                <div id="dashboard-total-present" class="display-4 fw-bolder text-warning-emphasis my-2">0</div>
                                <p class="text-muted small mb-0">Total days marked as "Present"</p>

                            </div>
                        </div>
                    </div>
                    <!-- Box 4: Calendar -->
                    <div class="col-3">
                        <div class="card h-100 shadow-sm rounded-3 calendar-wrapper overflow-hidden">
                            <div class="card-body p-3">
                                <h6 id="calendar-month-display" class="fw-bold text-center mb-2"></h6>
                                <div id="calendar-grid-header">
                                    <span class="p-1 text-center small fw-bold text-danger">S</span>
                                    <span class="p-1 text-center small fw-bold text-muted">M</span>
                                    <span class="p-1 text-center small fw-bold text-muted">T</span>
                                    <span class="p-1 text-center small fw-bold text-muted">W</span>
                                    <span class="p-1 text-center small fw-bold text-muted">T</span>
                                    <span class="p-1 text-center small fw-bold text-muted">F</span>
                                    <span class="p-1 text-center small fw-bold text-muted">S</span>
                                </div>
                                <div id="calendar-grid">
                                    <!-- Calendar days will be rendered by JS -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- ======== 5. MONTHLY SUMMARY ======== -->
            <section id="summary-section" class="page-section">
                <h2 class="mb-4 fade-in-section">Monthly Summary</h2>
                
                <!-- Grid Container (NEW: Added .fade-in-section) -->
                <div class="row g-3 row-cols-5 fade-in-section">
                    <!-- 1. Total Hours -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-1 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-clock-history icon text-primary mb-1"></i>
                                <p class="small text-muted mb-1">Total Hours</p>
                                <p id="summary-total-hours" class="value text-primary mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 2. Late -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-2 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-alarm icon text-danger mb-1"></i>
                                <p class="small text-muted mb-1">Late</p>
                                <p id="summary-late" class="value text-danger mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 3. Absent -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-3 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-person-x icon text-danger mb-1"></i>
                                <p class="small text-muted mb-1">Absent</p>
                                <p id="summary-absent" class="value text-danger mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 4. Weekends -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-4 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-calendar3-week icon text-info mb-1"></i>
                                <p class="small text-muted mb-1">Weekends</p>
                                <p id="summary-weekends" class="value text-info mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 5. Holidays -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-1 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-brightness-high icon text-warning mb-1"></i>
                                <p class="small text-muted mb-1">Holidays</p>
                                <p id="summary-holidays" class="value text-warning mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 6. Working Days -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-2 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-briefcase icon text-success mb-1"></i>
                                <p class="small text-muted mb-1">Working Days</p>
                                <p id="summary-working-days" class="value text-success mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 7. Total Present -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-3 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-person-check icon text-success mb-1"></i>
                                <p class="small text-muted mb-1">Total Present</p>
                                <p id="summary-total-present" class="value text-success mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 8. Night Shift -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-4 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-moon-stars icon text-secondary mb-1"></i>
                                <p class="small text-muted mb-1">Night Shift</p>
                                <p id="summary-night-shifts" class="value text-secondary mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 9. Day Shifts -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-1 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-sun icon text-warning-emphasis mb-1"></i>
                                <p class="small text-muted mb-1">Day Shifts</p>
                                <p id="summary-day-shifts" class="value text-warning-emphasis mb-0">0</p>
                            </div>
                        </div>
                    </div>
                    <!-- 10. Grace Used -->
                    <div class="col">
                        <div class="card summary-card gradient-card grad-2 rounded-3 h-100">
                            <div class="card-body p-3 text-center d-flex flex-column justify-content-center">
                                <i class="bi bi-shield-check icon text-primary-emphasis mb-1"></i>
                                <p class="small text-muted mb-1">Grace Used</p>
                                <p id="summary-grace-used" class="value text-primary-emphasis mb-0">0</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Comments Summary Section (NEW: Added .fade-in-section) -->
                <div id="comments-summary-section" class="mt-4 fade-in-section">
                    <h3 class="fw-semibold mb-3">Comments Summary</h3>
                    <div id="comments-summary-list" class="card card-body shadow-sm border-0 rounded-3">
                        <!-- Comments will be dynamically added here by JS -->
                    </div>
                </div>
            </section>
            
            <!-- ======== 6. DAILY ATTENDANCE INPUT ======== -->
            <section id="attendance-section" class="page-section">
                <div class="container-fluid px-lg-5">
                    <h2 class="mb-4 text-center text-lg-start fade-in-section">
                        Daily Attendance Input
                        <span id="attendance-date-range" class="fs-6 fw-normal text-primary ms-2 d-block d-lg-inline"></span>
                    </h2>
                    
                    <!-- NEW: Added .fade-in-section -->
                    <div class="table-responsive-wrapper shadow-sm rounded-3 fade-in-section">
                        <table class="table table-hover align-middle attendance-table">
                            <thead class="sticky-top">
                                <tr>
                                    <th>Date</th>
                                    <th>Day</th>
                                    <th>Status</th>
                                    <th>Hour</th>
                                    <th>Late</th>
                                    <th>Shift</th>
                                    <th>Grace</th>
                                    <th>Comments</th>
                                </tr>
                            </thead>
                            <tbody id="attendance-table-body">
                                <!-- Attendance rows will be generated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- ======== FOOTER ======== -->
            <!-- NEW: Added .fade-in-section -->
            <footer id="main-footer" class="fade-in-section">
                <div class="container-fluid">
                    <div class="row g-4">
                        <!-- Column 1: About -->
                        <div class="col-4">
                            <h5><i class="bi bi-bar-chart-line-fill me-2 text-primary"></i>My Portfolio</h5>
                            <p class="small">
                                Your personal dashboard for tracking monthly performance, attendance, and career milestones.
                            </p>
                            <div class="mt-3 social-links">
                                <a href="https://www.linkedin.com/in/pranto-rodrix-90463615b/" target="blank" title="LinkedIn"><i class="bi bi-linkedin"></i></a>
                                <a href="https://github.com/prantorodrix/Attendance-Tracker" target="blank" title="GitHub"><i class="bi bi-github"></i></a>
                                <a href="https://x.com/pranto83945" target="blank" title="Twitter"><i class="bi bi-twitter-x"></i></a>
                            </div>
                        </div>
                        
                        <!-- Column 2: Quick Links -->
                        <div class="col-2">
                            <h5>Quick Links</h5>
                            <ul class="footer-links">
                                <li><a href="#profile-section">Profile</a></li>
                                <li><a href="#performance-section">Performance</a></li>
                                <li><a href="#dashboard-section">Dashboard</a></li>
                                <li><a href="#attendance-section">Attendance</a></li>
                                <li><a href="#idr-notes-section">IDR Notes</a></li>
                            </ul>
                        </div>

                        <!-- Column 3: Help & Support -->
                        <div class="col-3">
                            <h5>Help & Support</h5>
                            <ul class="footer-links">
                                <li><a href="#">FAQs</a></li>
                                <li><a href="#">Report an Issue</a></li>
                                <li><a href="#">Documentation</a></li>
                                <li><a href="#">Contact Support</a></li>
                            </ul>
                        </div>
                        
                        <!-- Column 4: Contact Info -->
                        <div class="col-3">
                            <h5>Contact</h5>
                            <ul class="footer-links">
                                <li class="d-flex align-items-center">
                                    <i class="bi bi-telephone-fill me-2"></i>
                                    <a href="tel:+8801700000000">+8801318138951</a>
                                </li>
                                <li class="d-flex align-items-center">
                                    <i class="bi bi-envelope-fill me-2"></i>
                                    <a href="mailto:prantorodrix@example.com">prantorodrix9@gmail.com</a>
                                </li>
                                <li class="d-flex align-items-center">
                                    <i class="bi bi-geo-alt-fill me-2"></i>
                                    <span>Dhaka, Bangladesh</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                    <hr class="my-4">
                    <div class="text-center small">
                        <p class="mb-0">Made by <span class="fw-semibold text-primary"><a href="https://www.facebook.com/pranto.anthony1/" target="black" title="Facebook">@PrantoRodrix</a></span></p>
                        <p class="mb-0">&copy; <span id="footer-year">2025</span> My Portfolio. All rights reserved.</p>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- ======== PROFILE EDIT MODAL ======== -->
    <div class="modal fade zoom" id="edit-modal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <form id="profile-edit-form">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editModalLabel">Edit Profile</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row g-3">
                            <div class="col-12">
                                <label for="input-photo" class="form-label">Update Profile Photo</label>
                                <input type="file" id="input-photo" class="form-control" accept="image/*">
                            </div>
                            <!-- NEW: Cover Photo Input -->
                            <div class="col-12">
                                <label for="input-cover-photo" class="form-label">Update Cover Photo</label>
                                <input type="file" id="input-cover-photo" class="form-control" accept="image/*">
                            </div>
                            <div class="col-6">
                                <label for="input-name" class="form-label">Name</label>
                                <input type="text" id="input-name" class="form-control">
                            </div>
                            <div class="col-6">
                                <label for="input-designation-short" class="form-label">Designation (Short)</label>
                                <input type="text" id="input-designation-short" class="form-control">
                            </div>
                            <div class="col-6">
                                <label for="input-lng-id" class="form-label">LnG ID</label>
                                <input type="text" id="input-lng-id" class="form-control">
                            </div>
                            <div class="col-6">
                                <label for="input-team" class="form-label">Team</label>
                                <input type="text" id="input-team" class="form-control">
                            </div>
                            <!-- Joining Date Input -->
                            <div class="col-6">
                                <label for="input-joining-date" class="form-label">Joining Date</label>
                                <input type="date" id="input-joining-date" class="form-control">
                                <small id="joining-duration-preview" class="form-text text-muted mt-1 d-block"></small>
                            </div>
                            <div class="col-12">
                                <label for="input-designation-full" class="form-label">Designation (Full)</label>
                                <input type="text" id="input-designation-full" class="form-control">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" id="modal-cancel" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- ======== NEW: Email Edit Modal (REMOVED) ======== -->


    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" xintegrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        var links = document.querySelectorAll('a.force-self-load');
        links.forEach(function(link) {
            link.addEventListener('click', function(e) {
                // e.preventDefault() কে বাতিল করার জন্য কোনো জাভাস্ক্রিপ্ট না থাকলে এটি প্রয়োজন নেই।
                // তবে এটি জোর করে নেভিগেশন ঘটায়।
                window.location.href = link.href;
            });
        });
    });
  </script>
    <script>
        // --- GLOBAL APP STATE ---
        let appState = {
            currentUser: null,
            profile: {
                name: 'PrantoAnthony',
                designationShort: 'Junior Associate',
                joiningDate: '2021-10-03', 
                lngId: 'LnG2110R0218',
                empType: 'Resource pool',
                team: 'BCBS',
                designationFull: 'Junior Associate',
                photoSrc: null,
                coverPhotoSrc: null 
            },
            attendanceData: [],
            // notes: [] // REMOVED: My Notes feature is removed
        };

        let currentPeriodInfo = {
            workingDays: 0,
            colaNeeded: 20
        };
        
        const monthNames = [
            "January", "February", "March", "April", "May", "June",
            "July", "August", "September", "October", "November", "December"
        ];
        const daysInEnglish = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
        const statusCycle = ['-', 'Present', 'Absent', 'Weekend', 'Holiday'];
        
        // --- DOM Elements ---
        const htmlEl = document.documentElement;
        const loginPage = document.getElementById('login-page');
        const dashboardPage = document.getElementById('dashboard-page');
        const loginForm = document.getElementById('login-form');
        const loginAlert = document.getElementById('login-alert');
        const emailInput = document.getElementById('email-input');
        const passwordInput = document.getElementById('password-input');
        const logoutButton = document.getElementById('logout-button');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');
        const navLinks = document.querySelectorAll('#sidebar .nav-link');
        const pageSections = document.querySelectorAll('.page-section');
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        const themeText = document.getElementById('theme-text');
        const monthSelector = document.getElementById('month-selector');
        
        // --- MODAL FIX: Get elements for explicit listeners ---
        const editModalEl = document.getElementById('edit-modal');
        const editModal = new bootstrap.Modal(editModalEl); // Create instance
        const editForm = document.getElementById('profile-edit-form');
        const modalCancelButton = document.getElementById('modal-cancel');
        
        const photoInput = document.getElementById('input-photo');
        const profilePic = document.getElementById('profile-pic');
        const joiningDateInput = document.getElementById('input-joining-date');
        const joiningDurationPreview = document.getElementById('joining-duration-preview');
        
        // REMOVED: Notes Elements
        
        const coverPhotoImg = document.getElementById('profile-cover-photo');
        const coverPhotoInput = document.getElementById('input-cover-photo');

        const sidebarToggleButton = document.getElementById('sidebar-toggle-button');


        // --- DATA PERSISTENCE (LocalStorage per User) ---
        function loadData() {
            const savedData = localStorage.getItem(appState.currentUser);
            if (savedData) {
                const parsedData = JSON.parse(savedData);
                appState.profile = { ...appState.profile, ...parsedData.profile };
                appState.attendanceData = parsedData.attendanceData || [];
                // appState.notes = parsedData.notes || []; // REMOVED
            } else {
                appState.profile = {
                    name: 'PrantoAnthony',
                    designationShort: 'Junior Associate',
                    joiningDate: '2021-10-03',
                    lngId: 'LnG2110R0218',
                    empType: 'Resource pool',
                    team: 'BCBS',
                    designationFull: 'Junior Associate',
                    photoSrc: null,
                    coverPhotoSrc: null 
                };
                appState.attendanceData = [];
                // appState.notes = []; // REMOVED
            }
            updateProfileUI();
            // REMOVED: Notes UI update
        }

        function saveData() {
            if (!appState.currentUser) return;
            
            const dataToSave = {
                profile: appState.profile,
                attendanceData: appState.attendanceData,
                // notes: appState.notes // REMOVED
            };
            localStorage.setItem(appState.currentUser, JSON.stringify(dataToSave));
            // notesLastSaved.textContent = new Date().toLocaleTimeString(); // REMOVED
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('footer-year').textContent = new Date().getFullYear();

            const loggedInUser = sessionStorage.getItem('currentUser');
            if (loggedInUser) {
                appState.currentUser = loggedInUser;
                showDashboard();
                initializeApp();
            } else {
                showLogin();
            }

            setupEventListeners();
            setupScrollRevealObserver(); 
            const savedTheme = localStorage.getItem('theme') || 'light';
            setTheme(savedTheme);
            
            // REMOVED: Setup IDR Notes listeners
        });

        function initializeApp() {
            loadData(); 
            populateMonthSelector();
            const currentMonthValue = monthSelector.value;
            updateDateRange(currentMonthValue); 
            setupScrollSpyObserver(); 
            updateAnimatedBackground(); 
        }

        // --- PAGE/VIEW MANAGEMENT ---
        function showLogin() {
            loginPage.style.display = 'flex';
            dashboardPage.style.display = 'none';
        }

        function showDashboard() {
            loginPage.style.display = 'none';
            dashboardPage.style.display = 'flex';
        }

        // --- EVENT LISTENERS ---
        function setupEventListeners() {
            // Login
            loginForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = emailInput.value;
                const password = passwordInput.value;
                
                if (email.endsWith('@leverngear.com') && password === 'pranto') {
                    appState.currentUser = email;
                    sessionStorage.setItem('currentUser', email);
                    loginAlert.classList.add('d-none');
                    showDashboard();
                    initializeApp();
                } else {
                    loginAlert.classList.remove('d-none');
                }
            });

            // Logout
            logoutButton.addEventListener('click', () => {
                appState.currentUser = null;
                sessionStorage.removeItem('currentUser');
                emailInput.value = '';
                passwordInput.value = '';
                showLogin();
                appState.attendanceData = []; 
                // appState.notes = []; // REMOVED
            });

            // NEW: Sidebar Toggle
            sidebarToggleButton.addEventListener('click', () => {
                sidebar.classList.toggle('minimized');
                mainContent.classList.toggle('sidebar-minimized');
            });

            // Sidebar Navigation (Smooth Scroll)
            navLinks.forEach(link => {
                // Don't add smooth scroll to dropdown toggles or external links
                const isDropdownToggle = link.getAttribute('data-bs-toggle') === 'collapse';
                const isExternal = link.getAttribute('target') === '_blank';
                
                if (!isDropdownToggle && !isExternal) {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        
                        // Find all nav links, including submenu links
                        document.querySelectorAll('#sidebar .nav-link').forEach(l => l.classList.remove('active'));
                        
                        this.classList.add('active');
                        
                        const targetId = this.getAttribute('href');
                        const targetElement = document.querySelector(targetId);
                        
                        if (targetElement) {
                            document.getElementById('main-content').scrollTo({
                                top: targetElement.offsetTop - 30, 
                                behavior: 'smooth'
                            });
                        }
                    });
                }
            });

            // Theme Toggle
            themeToggle.addEventListener('click', () => {
                const newTheme = htmlEl.getAttribute('data-bs-theme') === 'dark' ? 'light' : 'dark';
                setTheme(newTheme);
            });

            // Month Selector
            monthSelector.addEventListener('change', (e) => {
                updateDateRange(e.target.value);
            });
            
            // --- NEW PROFILE MODAL FIX ---
            // Profile Edit Form Submit
            if (editForm) {
                editForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    appState.profile.name = document.getElementById('input-name').value.trim();
                    appState.profile.designationShort = document.getElementById('input-designation-short').value.trim();
                    appState.profile.lngId = document.getElementById('input-lng-id').value.trim();
                    appState.profile.team = document.getElementById('input-team').value.trim();
                    appState.profile.designationFull = document.getElementById('input-designation-full').value.trim();
                    appState.profile.joiningDate = joiningDateInput.value;
                    
                    updateProfileUI();
                    saveData();
                    editModal.hide(); // Use the instance
                });
            }
            
            // Explicit listener for cancel button
            if (modalCancelButton) {
                modalCancelButton.addEventListener('click', () => {
                    editModal.hide(); // Use the instance
                });
            }
            
            // Populate modal on show
            if(editModalEl) {
                editModalEl.addEventListener('show.bs.modal', () => {
                    document.getElementById('input-name').value = appState.profile.name;
                    document.getElementById('input-designation-short').value = appState.profile.designationShort;
                    document.getElementById('input-lng-id').value = appState.profile.lngId;
                    document.getElementById('input-team').value = appState.profile.team;
                    document.getElementById('input-designation-full').value = appState.profile.designationFull;
                    joiningDateInput.value = appState.profile.joiningDate;
                    
                    const duration = calculateJoiningDuration(appState.profile.joiningDate);
                    joiningDurationPreview.textContent = duration.full;
                    
                    photoInput.value = null; 
                    coverPhotoInput.value = null;
                });
            }
            // --- END PROFILE MODAL FIX ---


            // --- NEW COVER PHOTO FIX ---
            // Profile Photo Upload
            if (photoInput) {
                photoInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    const profileReader = new FileReader(); // Renamed variable
                    profileReader.onload = (event) => {
                        const dataUrl = event.target.result;
                        profilePic.src = dataUrl;
                        appState.profile.photoSrc = dataUrl;
                        saveData(); 
                    };
                    profileReader.readAsDataURL(file);
                });
            }
            
            // Cover Photo Upload
            if (coverPhotoInput) {
                coverPhotoInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (!file) return;
                    
                    const coverReader = new FileReader(); // Renamed variable
                    coverReader.onload = (event) => {
                        const dataUrl = event.target.result;
                        coverPhotoImg.src = dataUrl;
                        appState.profile.coverPhotoSrc = dataUrl;
                        saveData(); 
                    };
                    coverReader.readAsDataURL(file);
                });
            }
            // --- END COVER PHOTO FIX ---


            // Listener for date input change
            joiningDateInput.addEventListener('input', (e) => {
                const duration = calculateJoiningDuration(e.target.value);
                joiningDurationPreview.textContent = duration.full;
            });

            // REMOVED: Notes Listeners

            // NEW: Background Scroll Listener
            mainContent.addEventListener('scroll', handleBackgroundScroll);
        }

        // --- NEW: Handle Background Scroll Effect ---
        function handleBackgroundScroll() {
            updateAnimatedBackground();
        }
        
        // --- NEW: Update Animated Background Function ---
        function updateAnimatedBackground() {
            // Select only the images for the *current* theme
            const theme = htmlEl.getAttribute('data-bs-theme');
            const bgImages = document.querySelectorAll(`.bg-image-${theme}`);
            if (bgImages.length === 0) return;

            const scrollableHeight = mainContent.scrollHeight - mainContent.clientHeight;
            if (scrollableHeight <= 0) { // Fix for no scrollbar
                 bgImages.forEach((img, index) => {
                    img.classList.toggle('active', index === 0);
                });
                return;
            }
            
            const scrollPercentage = (mainContent.scrollTop / scrollableHeight) * 100;
            
            const segment = 100 / bgImages.length;
            let activeIndex = Math.floor(scrollPercentage / segment);
            
            if (activeIndex >= bgImages.length) {
                activeIndex = bgImages.length - 1;
            }

            // Update active class
            bgImages.forEach((img, index) => {
                img.classList.toggle('active', index === activeIndex);
            });
        }


        // --- Intersection Observer for Scroll Spying ---
        function setupScrollSpyObserver() {
            // Observe scrolling within the main-content element
            const observerOptions = {
                root: mainContent, 
                rootMargin: '-10% 0px -85% 0px',
                threshold: 0
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.id;
                        // Check if user is actively clicking a link
                        const activeLink = document.querySelector('#sidebar .nav-link.active');
                        const activeLinkHref = activeLink ? activeLink.getAttribute('href') : '';
                        
                        // Only update scrollspy if the active link isn't the one being clicked
                        // (prevents jitter)
                        if (activeLinkHref !== `#${id}`) {
                             navLinks.forEach(link => {
                                const isDropdownToggle = link.getAttribute('data-bs-toggle') === 'collapse';
                                const isExternal = link.getAttribute('target') === '_blank';
                                
                                // Only apply to main section links
                                if (!isDropdownToggle && !isExternal) {
                                    link.classList.remove('active');
                                    if (link.getAttribute('href') === `#${id}`) {
                                        link.classList.add('active');
                                    }
                                }
                            });
                        }
                    }
                });
            }, observerOptions);

            pageSections.forEach(section => {
                if(section) observer.observe(section);
            });
        }

        // --- NEW: Intersection Observer for Scroll REVEAL ---
        function setupScrollRevealObserver() {
            const sectionsToAnimate = document.querySelectorAll('.fade-in-section');

            const observerOptions = {
                root: mainContent, // Animate based on main content viewport
                rootMargin: '0px',
                threshold: 0.1 // Trigger when 10% of the element is visible
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target); // Animate only once
                    }
                });
            }, observerOptions);

            sectionsToAnimate.forEach(section => {
                observer.observe(section);
            });
        }
        // --- End Scroll Reveal ---


        // --- THEME ---
        function setTheme(theme) {
            htmlEl.setAttribute('data-bs-theme', theme);
            localStorage.setItem('theme', theme);
            if (theme === 'dark') {
                themeIcon.classList.remove('bi-sun-fill');
                themeIcon.classList.add('bi-moon-fill');
                themeText.textContent = 'Dark Mode';
            } else {
                themeIcon.classList.remove('bi-moon-fill');
                themeIcon.classList.add('bi-sun-fill');
                themeText.textContent = 'Light Mode';
            }
            // NEW: Update background on theme change
            updateAnimatedBackground();
        }

        // --- Joining Date Calculation ---
        function calculateJoiningDuration(joiningDateString) {
            if (!joiningDateString) {
                return { full: 'Please select a date.', days: 0 };
            }

            try {
                const joiningDate = new Date(joiningDateString);
                const today = new Date();
                joiningDate.setUTCHours(12, 0, 0, 0);
                today.setUTCHours(12, 0, 0, 0);

                if (joiningDate > today) {
                    return { full: 'Joining date cannot be in the future.', days: 0 };
                }

                let years = today.getUTCFullYear() - joiningDate.getUTCFullYear();
                let months = today.getUTCMonth() - joiningDate.getUTCMonth();
                let days = today.getUTCDate() - joiningDate.getUTCDate();

                if (days < 0) {
                    months--;
                    const prevMonth = new Date(today.getUTCFullYear(), today.getUTCMonth(), 0);
                    days += prevMonth.getUTCDate();
                }

                if (months < 0) {
                    years--;
                    months += 12;
                }

                const totalDays = Math.floor((today - joiningDate) / (1000 * 60 * 60 * 24));
                
                const yearStr = years > 0 ? `${years} ${years > 1 ? 'Years' : 'Year'}` : '';
                const monthStr = months > 0 ? `${months} ${months > 1 ? 'Months' : 'Month'}` : '';
                const dayStr = days > 0 ? `${days} ${days > 1 ? 'Days' : 'Day'}` : '';
                
                const parts = [yearStr, monthStr, dayStr].filter(Boolean);
                let fullString = parts.join(', ');

                if (parts.length === 0) {
                    fullString = (totalDays === 0) ? 'Joined today' : `${totalDays} ${totalDays > 1 ? 'Days' : 'Day'}`;
                }
                
                return { full: fullString, days: totalDays };

            } catch (error) {
                return { full: 'Invalid date format.', days: 0 };
            }
        }

        // --- UI UPDATERS ---
        function updateProfileUI() {
            document.getElementById('name-display').textContent = appState.profile.name;
            document.getElementById('designation-short-display').textContent = appState.profile.designationShort;
            
            const duration = calculateJoiningDuration(appState.profile.joiningDate);
            document.getElementById('joining-duration-display').textContent = duration.full;

            document.getElementById('lng-id-display').textContent = appState.profile.lngId;
            document.getElementById('emp-type-display').textContent = appState.profile.empType;
            document.getElementById('team-display').textContent = appState.profile.team;
            document.getElementById('designation-full-display').textContent = appState.profile.designationFull;

            if (appState.profile.photoSrc) {
                profilePic.src = appState.profile.photoSrc;
            } else {
                const initials = (appState.profile.name || 'PA').split(' ').map(n => n[0]).join('').substring(0, 2).toUpperCase();
                profilePic.src = `https://placehold.co/150x150/0d6efd/ffffff?text=${initials}`;
            }

            // NEW: Update Cover Photo
            if (appState.profile.coverPhotoSrc) {
                coverPhotoImg.src = appState.profile.coverPhotoSrc;
            } else {
                coverPhotoImg.src = "https://placehold.co/1000x250/6a11cb/ffffff?text=Upload+Cover+Photo";
            }
        }

        function populateMonthSelector() {
            monthSelector.innerHTML = '';
            const now = new Date();
            for (let i = -6; i <= 6; i++) {
                const date = new Date(now.getFullYear(), now.getMonth() + i, 1);
                const monthName = monthNames[date.getMonth()];
                const year = date.getFullYear();
                
                const option = document.createElement('option');
                option.value = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;
                option.textContent = `${monthName} ${year}`;
                if (i === 0) option.selected = true;
                monthSelector.appendChild(option);
            }
        }

        // --- REMOVED: Notes UI Functions ---

        // --- CORE LOGIC & RENDERING ---
        function updateDateRange(selectedMonthYear) {
            const [year, month] = selectedMonthYear.split('-').map(Number);
            
            const fromDate = new Date(year, month - 2, 26);
            const toDate = new Date(year, month - 1, 25);
            
            const options = { month: 'short', day: 'numeric', year: 'numeric' };
            const fromDateStr = fromDate.toLocaleDateString('en-US', options);
            const toDateStr = toDate.toLocaleDateString('en-US', options);

            document.getElementById('date-from').textContent = fromDateStr;
            document.getElementById('date-to').textContent = toDateStr;
            document.getElementById('attendance-date-range').textContent = `(${fromDateStr} - ${toDateStr})`;

            generateAttendanceData(fromDate, toDate); 
            renderAttendanceTable(fromDate, toDate);
            runAllCalculations(fromDate, toDate);
            renderCalendar(year, month);
        }

        function generateAttendanceData(fromDate, toDate) {
            let currentDate = new Date(fromDate);
            let calculatedWorkingDays = 0;
            let totalSundays = 0;
            let totalDaysInPeriod = 0;
            let totalHolidaysInPeriod = 0; 
            
            const dateOptions = { month: 'short', day: 'numeric' };

            while (currentDate <= toDate) {
                const dayName = daysInEnglish[currentDate.getDay()];
                const dateString = currentDate.toLocaleDateString('en-US', dateOptions).replace(',', '');
                const isoDate = currentDate.toISOString().split('T')[0];
                const isWeekend = currentDate.getDay() === 0;

                const existingData = appState.attendanceData.find(d => d.isoDate === isoDate);

                if (!existingData) {
                    const rowData = {
                        id: isoDate, 
                        isoDate: isoDate,
                        dateString: dateString,
                        dayName: dayName,
                        status: '-', 
                        hour: '-',
                        late: '-',
                        shift: 'Day',
                        grace: '-',
                        comments: '',
                        isWeekend: isWeekend
                    };
                    appState.attendanceData.push(rowData);
                } else {
                    if (existingData.status === 'Holiday') {
                        totalHolidaysInPeriod++;
                    }
                }
                
                totalDaysInPeriod++;
                if (isWeekend) totalSundays++;
                else calculatedWorkingDays++;

                currentDate.setDate(currentDate.getDate() + 1);
            }
            
            calculatedWorkingDays -= totalHolidaysInPeriod;
            
            let colaNeeded = 20;
            if (calculatedWorkingDays >= 26) colaNeeded = 22;
            else if (calculatedWorkingDays >= 24) colaNeeded = 21;
            
            currentPeriodInfo = {
                workingDays: calculatedWorkingDays,
                colaNeeded: colaNeeded,
                totalDays: totalDaysInPeriod,
                totalSundays: totalSundays,
                totalHolidays: totalHolidaysInPeriod 
            };
            
            saveData();
        }

        function renderAttendanceTable(fromDate, toDate) {
            const tableBody = document.getElementById('attendance-table-body');
            tableBody.innerHTML = '';

            const fromISO = fromDate.toISOString().split('T')[0];
            const toISO = toDate.toISOString().split('T')[0];

            const periodData = appState.attendanceData
                .filter(row => row.isoDate >= fromISO && row.isoDate <= toISO)
                .sort((a, b) => a.isoDate.localeCompare(b.isoDate)); 
            
            periodData.forEach(row => {
                const persistentId = row.isoDate; 
                
                const tr = document.createElement('tr');
                tr.id = `row-card-${persistentId}`;
                
                const weekendClass = row.isWeekend ? 'text-danger' : '';
                
                // --- NEW: Editable Hour Input ---
                tr.innerHTML = `
                    <td class="fw-medium ${weekendClass}">${row.dateString}</td>
                    <td class="${weekendClass}">${row.dayName}</td>
                    <td>
                        <button id="status-${persistentId}" class="btn w-100 btn-sm status-btn status-${row.status.toLowerCase()}" onclick="cycleStatus('${persistentId}')">
                            ${row.status}
                        </button>
                    </td>
                    <td>
                        <input type="text" id="hour-${persistentId}" class="form-control form-control-sm text-center" value="${row.hour}" oninput="updateLateFromHour('${persistentId}')" disabled>
                    </td>
                    <td>
                        <input type="text" id="late-${persistentId}" class="form-control form-control-sm text-center no-arrows" value="${row.late}" oninput="updateHourFromLate('${persistentId}')" disabled>
                    </td>
                    <td>
                        <button id="shift-${persistentId}" class="btn-text-like" onclick="toggleShift('${persistentId}')" disabled>
                            ${row.shift}
                        </button>
                    </td>
                    <td>
                        <button id="grace-${persistentId}" class="btn-text-like" onclick="toggleGrace('${persistentId}')" disabled>
                            ${row.grace}
                        </button>
                    </td>
                    <td>
                        <input type="text" id="comments-${persistentId}" class="form-control form-control-sm" value="${row.comments}" oninput="updateData('${persistentId}', 'comments', this.value)" disabled>
                    </td>
                `;
                tableBody.appendChild(tr);
                
                updateRowState(persistentId, row.status, false); 
            });
        }
        
        // --- DATA HANDLERS (CALLED FROM UI) ---

        function cycleStatus(rowId) {
            const rowData = appState.attendanceData.find(d => d.isoDate === rowId);
            if (!rowData) return;

            const currentIndex = statusCycle.indexOf(rowData.status);
            const nextIndex = (currentIndex + 1) % statusCycle.length;
            const nextStatus = statusCycle[nextIndex];
            
            rowData.status = nextStatus;

            const statusBtn = document.getElementById(`status-${rowId}`);
            statusBtn.textContent = nextStatus;
            statusBtn.className = `btn w-100 btn-sm status-btn status-${nextStatus.toLowerCase()}`;

            updateRowState(rowId, nextStatus, true);
            updateDateRange(monthSelector.value); 
        }
        window.cycleStatus = cycleStatus;

        function toggleShift(rowId) {
            const rowData = appState.attendanceData.find(d => d.isoDate === rowId);
            if (!rowData) return;
            
            rowData.shift = (rowData.shift === 'Day') ? 'Night' : 'Day';
            document.getElementById(`shift-${rowId}`).textContent = rowData.shift;
            
            updateDateRange(monthSelector.value);
        }
        window.toggleShift = toggleShift; 

        function toggleGrace(rowId) {
            const rowData = appState.attendanceData.find(d => d.isoDate === rowId);
            if (!rowData) return;
            
            rowData.grace = (rowData.grace === '-') ? 'Yes' : '-';
            document.getElementById(`grace-${rowId}`).textContent = rowData.grace;
            
            updateDateRange(monthSelector.value);
        }
        window.toggleGrace = toggleGrace;

        function updateData(rowId, key, value) {
            const rowData = appState.attendanceData.find(d => d.isoDate === rowId);
            if (!rowData) return;
            
            rowData[key] = value;
            saveData();
            runAllCalculations(new Date(monthSelector.value.split('-')[0], monthSelector.value.split('-')[1] - 2, 26), new Date(monthSelector.value.split('-')[0], monthSelector.value.split('-')[1] - 1, 25));
        }
        window.updateData = updateData;
        
        // --- NEW: Editable Hour/Late Logic ---
        function updateLateFromHour(rowId) {
            const rowData = appState.attendanceData.find(d => d.isoDate === rowId);
            if (!rowData) return;

            const hourInput = document.getElementById(`hour-${rowId}`);
            const lateInput = document.getElementById(`late-${rowId}`);
            
            let hourValue = parseFloat(hourInput.value);
            if (isNaN(hourValue)) {
                if (hourInput.value.trim() === '-') {
                    rowData.hour = '-';
                    rowData.late = '-';
                    lateInput.value = '-';
                }
                saveData();
                return;
            }

            if (hourValue > 9) hourValue = 9;
            if (hourValue < 0) hourValue = 0;
            
            rowData.hour = hourValue;
            rowData.late = '-'; // When hour is manually set, late becomes irrelevant
            lateInput.value = '-';
            
            saveData();
            // No full update needed, just save
        }
        window.updateLateFromHour = updateLateFromHour;

        function updateHourFromLate(rowId) {
            const rowData = appState.attendanceData.find(d => d.isoDate === rowId);
            if (!rowData) return;
            
            const lateInput = document.getElementById(`late-${rowId}`);
            const hourInput = document.getElementById(`hour-${rowId}`);
            const baseHour = 9;
            
            let lateValue = parseFloat(lateInput.value);
            if (isNaN(lateValue)) {
                 if (lateInput.value.trim() === '-') {
                    rowData.late = '-';
                    rowData.hour = '-';
                    hourInput.value = '-';
                 }
                saveData();
                return;
            }
            
            let newHour;

            if (lateValue > baseHour) lateValue = baseHour;
            if (lateValue < 0) lateValue = 0;
            
            newHour = (baseHour - lateValue);
            
            hourInput.value = newHour.toFixed(1).replace('.0', '');
            
            rowData.late = lateValue;
            rowData.hour = newHour;
            
            saveData();
            // No full update needed, just save
        }
        window.updateHourFromLate = updateHourFromLate; 
        
        // --- END: Editable Hour/Late Logic ---

        
        // --- STATE/CALCULATION LOGIC ---

        function updateRowState(rowId, status, resetData) {
            const inputs = [
                document.getElementById(`late-${rowId}`),
                document.getElementById(`shift-${rowId}`),
                document.getElementById(`grace-${rowId}`),
                document.getElementById(`comments-${rowId}`)
            ];
            const hourInput = document.getElementById(`hour-${rowId}`); // Get hour input
            const rowData = appState.attendanceData.find(d => d.isoDate === rowId);
            if (!rowData) return;

            const isDisabled = (status !== 'Present');
            
            // --- NEW: Enable/Disable all inputs ---
            inputs.forEach(el => { if (el) el.disabled = isDisabled; });
            if (hourInput) hourInput.disabled = isDisabled;
            // --- END NEW ---
            
            if (resetData) {
                if (status === 'Present') {
                    rowData.hour = 9;
                    rowData.late = 0;
                    rowData.shift = 'Day';
                    rowData.grace = '-';
                } else {
                    const defaultValue = (status === '-') ? '-' : 0;
                    rowData.hour = defaultValue;
                    rowData.late = defaultValue;
                    rowData.shift = 'Day';
                    rowData.grace = '-';
                }
            }
            
            if(hourInput) {
                if (typeof rowData.hour === 'number') {
                    hourInput.value = (rowData.hour === 9 || rowData.hour === 0) ? rowData.hour.toFixed(0) : rowData.hour.toFixed(1).replace('.0', '');
                } else {
                    hourInput.value = rowData.hour; 
                }
            }
            if(inputs[0]) { 
                if (typeof rowData.late === 'number') {
                    inputs[0].value = (rowData.late === 0) ? rowData.late.toFixed(0) : rowData.late;
                } else {
                    inputs[0].value = rowData.late; 
                }
            }
            if(inputs[1]) inputs[1].textContent = rowData.shift;
            if(inputs[2]) inputs[2].textContent = rowData.grace;
            if(inputs[3]) inputs[3].value = rowData.comments;
        }

        function runAllCalculations(fromDate, toDate) {
            const fromISO = fromDate.toISOString().split('T')[0];
            const toISO = toDate.toISOString().split('T')[0];

            const periodData = appState.attendanceData
                .filter(row => row.isoDate >= fromISO && row.isoDate <= toISO);

            let totalHours = 0, totalLate = 0, totalAbsent = 0, totalWeekends = 0,
                totalHolidays = 0, totalPresent = 0, totalNightShifts = 0,
                totalDayShifts = 0, totalGrace = 0;

            for (const row of periodData) {
                if (row.status === 'Present') {
                    totalPresent++;
                    totalHours += parseFloat(row.hour) || 0;
                    // Only count late if it's a number (not '-')
                    if(typeof row.late === 'number') {
                        totalLate += parseFloat(row.late) || 0; 
                    }
                    if (row.shift === 'Day') totalDayShifts++;
                    if (row.shift === 'Night') totalNightShifts++;
                    if (row.grace === 'Yes') totalGrace++;
                }
                else if (row.status === 'Absent') totalAbsent++;
                else if (row.status === 'Weekend') totalWeekends++;
                else if (row.status === 'Holiday') totalHolidays++;
            }
            
            const totalDaysInPeriod = currentPeriodInfo.workingDays; 
            const colaNeeded = currentPeriodInfo.colaNeeded;

            // 1. Performance Boxes
            document.getElementById('data-box-working-days').textContent = totalDaysInPeriod;
            document.getElementById('data-box-cola').textContent = `${totalPresent} / ${colaNeeded}`;
            document.getElementById('data-box-cola-needed').textContent = `Need present: ${colaNeeded} days`;
            const colaPerc = (colaNeeded === 0) ? 0 : (totalPresent / colaNeeded) * 100;
            document.getElementById('cola-progress-bar').style.width = `${Math.min(colaPerc, 100)}%`;
            
            const presentPercentage = (totalDaysInPeriod === 0) ? 0 : (totalPresent / totalDaysInPeriod) * 100;
            let category = 'N/A';
            let categoryDesc = 'No data';
            if (totalDaysInPeriod > 0 && (totalPresent > 0 || totalAbsent > 0)) { 
                if (presentPercentage >= 90) { category = 'A'; categoryDesc = 'Excellent Performance'; }
                else if (presentPercentage >= 85) { category = 'B'; categoryDesc = 'Very Good Performance'; }
                else if (presentPercentage >= 80) { category = 'C'; categoryDesc = 'Good Performance'; }
                else if (presentPercentage >= 75) { category = 'D'; categoryDesc = 'Needs Improvement'; }
                else { category = 'E'; categoryDesc = 'Failure'; }
            }
            document.getElementById('data-box-category').textContent = category;
            document.getElementById('data-box-category-desc').textContent = `(${presentPercentage.toFixed(0)}%) ${categoryDesc}`;

            // 2. Slideshow
            const monthName = monthNames[new Date(monthSelector.value + '-02').getMonth()];
            document.getElementById('slide-selected-month').textContent = `${monthName} ${monthSelector.value.split('-')[0]}`;
            document.getElementById('slide-total-days').textContent = currentPeriodInfo.totalDays;
            document.getElementById('slide-total-sundays').textContent = currentPeriodInfo.totalSundays;
            document.getElementById('slide-total-holidays').textContent = totalHolidays;
            document.getElementById('slide-working-days').textContent = currentPeriodInfo.workingDays;
            
            // 3. Dashboard Boxes
            const dutyDays = totalPresent + totalAbsent;
            const dashboardPresentPerc = (dutyDays === 0) ? 0 : (totalPresent / dutyDays) * 100;
            document.getElementById('dashboard-present-percentage').textContent = `${dashboardPresentPerc.toFixed(0)}%`;
            document.getElementById('dashboard-total-present').textContent = totalPresent;

            // 4. Monthly Summary
            document.getElementById('summary-total-hours').textContent = totalHours.toFixed(1).replace('.0', ''); 
            document.getElementById('summary-late').textContent = totalLate.toFixed(1).replace('.0', '');
            document.getElementById('summary-absent').textContent = totalAbsent;
            document.getElementById('summary-weekends').textContent = totalWeekends;
            document.getElementById('summary-holidays').textContent = totalHolidays;
            document.getElementById('summary-working-days').textContent = dutyDays; 
            document.getElementById('summary-total-present').textContent = totalPresent;
            document.getElementById('summary-night-shifts').textContent = totalNightShifts;
            document.getElementById('summary-day-shifts').textContent = totalDayShifts;
            document.getElementById('summary-grace-used').textContent = totalGrace;

            // 5. Comments (Pass the filtered data)
            updateCommentsSummary(periodData);
            
            // 6. Calendar
            // This is called separately in updateDateRange
        }

        function updateCommentsSummary(periodData) {
            const listDiv = document.getElementById('comments-summary-list');
            listDiv.innerHTML = '';
            let hasComments = false;

            for (const row of periodData) {
                if (row.comments && row.comments.trim() !== '') {
                    hasComments = true;
                    const p = document.createElement('p');
                    p.className = 'mb-2 border-bottom pb-2';
                    
                    let presentInfo = '';
                    if (row.status === 'Present') {
                        // FIX: Check if hour is number before toFixed
                        let hourText = (typeof row.hour === 'number') ? row.hour.toFixed(1).replace('.0', '') : row.hour;
                        presentInfo = `Present: ${hourText} hrs (${row.shift}), `;
                    }
                    else if (row.status !== '-') presentInfo = `Status: ${row.status}, `;

                    p.innerHTML = `<strong class="text-primary">${row.dateString} (${row.dayName}):</strong> ${presentInfo}${row.comments}`;
                    listDiv.appendChild(p);
                }
            }

            if (!hasComments) {
                listDiv.innerHTML = '<p class="text-muted text-center italic mb-0">No comments added for this period...</p>';
            }
        }

        function renderCalendar(year, month) {
            const calendarGrid = document.getElementById('calendar-grid');
            const monthDisplay = document.getElementById('calendar-month-display');
            calendarGrid.innerHTML = '';

            const firstDayOfMonth = new Date(year, month - 1, 1);
            const daysInMonth = new Date(year, month, 0).getDate();
            const startDayOfWeek = firstDayOfMonth.getDay();

            monthDisplay.textContent = firstDayOfMonth.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });

            for (let i = 0; i < startDayOfWeek; i++) {
                calendarGrid.innerHTML += `<span class="calendar-day-item p-1 rounded"></span>`;
            }

            const today = new Date();
            const todayStr = today.toISOString().split('T')[0];

            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(year, month - 1, day);
                const isoDate = date.toISOString().split('T')[0];
                
                const rowData = appState.attendanceData.find(d => d.isoDate === isoDate);
                
                let dayClasses = 'calendar-day-item p-1 rounded d-flex align-items-center justify-content-center';
                
                if (isoDate === todayStr) {
                    dayClasses += ' today';
                }

                if (rowData && rowData.status !== '-') {
                    const statusClass = rowData.status.toLowerCase();
                    dayClasses += ` status-${statusClass.toLowerCase()}-bg has-data`;
                } else if (rowData && rowData.isWeekend) {
                    dayClasses += ` status-weekend-bg has-data opacity-50`;
                }
                 else {
                    dayClasses += ' bg-body-tertiary opacity-50';
                }
                
                calendarGrid.innerHTML += `<span class="${dayClasses}">${day}</span>`;
            }
        }
        
        
        // --------------------------------------------------
        // --- REMOVED: IDR NOTES SECTION SCRIPT ---
        // --------------------------------------------------

    </script>
</body>
</html>

}
